<aura:component controller="Managment" implements="flexipage:availableForAllPageTypes"  access="global" >
    
    <aura:attribute name="data" type="object"/>
    <aura:attribute name="columns" type="List"/>
    <aura:attribute name="sortedBy" type="String"/>
    <aura:attribute name="sortedDirection" type="String"/>
    <aura:attribute name="isupdating" type="boolean" default="false"/>
    <aura:attribute name="defaultSortDirection" type="String" /> 
    <aura:attribute name="selection" type="List" />
    <aura:attribute name="selectedRecord" type="List" default= "[]"/>
    <aura:attribute name="selectedRowsCount" type="Integer" default="0"/>
    <aura:attribute name="hasPageChanged" type="Boolean" />
    <aura:attribute name="initialLoad" type="Boolean" default="true"/>
    <aura:attribute name="TotalCount" type="integer" default="0"/>
    
    <aura:handler name="init" value="{!this}" action="{!c.init}" />
    <aura:attribute name="programList" type="object"/>
    
    <aura:attribute name="StatusPickList" type="list"/>
     <aura:attribute name="tableSearch" type="String"/>
    
    <aura:attribute name="allData" type="List"/>
    
    <aura:attribute name="currentPageNumber" type="Integer" default="1"/>
    <aura:attribute name="pageSize" type="Integer" default="20"/>
    <aura:attribute name="totalPages" type="Integer" default="0"/>
    <aura:attribute name="pageList" type="List"/>
    
     <aura:attribute name="iscustomizetableopen" type="boolean" default="false"/>
     <aura:attribute name="requiredOptions" type="List" default="[]"/>
    <aura:attribute name="options" type="List" default="[]"/>
    <aura:attribute name="values" type="List" default="[]"/>
     <aura:attribute name="columnsorder" type="object"/>
      <aura:attribute name="globalvar" type="Integer[]" />
     <aura:attribute name="reccount" type="Integer[]" />
    
     <aura:attribute name="spinner" type="boolean" default="true"/>
     <aura:handler event="aura:waiting" action="{!c.showSpinner}"/>
    <aura:handler event="aura:doneWaiting" action="{!c.hideSpinner}"/>
    
    <div>
        <div class="c-container-1">
            <!--<aura:iteration items="{!v.TotalCount}" var="count">-->
            
            <h1 class="styles">Program Management({!v.TotalCount})</h1>
            <!--</aura:iteration>-->
            <p class="spacing">Enable Sellers with Sales Program to reach goals faster</p>
            
            <div class="c-container">
                <lightning:layout >
                    <lightning:layoutItem padding="around-none">
                        <div class="header-column">
                            <p class="field-title" title="Search Fields Program Name and Program Id" >
                                
                                <lightning:input class = "Search_Button" type="Search" label="Search" placeholder="Table Search" aura:id="SearchBox" name="RenewalSearch"
                                                 onchange="{!c.searchTable}" />
                            </p>
                        </div>
                    </lightning:layoutItem>
                    
                    
                    <lightning:layoutItem padding="around-none">
                        <div class="header-column">
                            <p class="field-title" title="Status" >
                               <!-- <lightning:select name="Status" label="Status" aura:id = "Status" required="false" value="{!v.RTM}">
                                    <option value="all">All</option>
                                    <option value="">Active</option>
                                    <option value="">Draft</option>
                                    <option value="">Expired</option>
                                    <option value="">Inactive</option>
                                    
                                </lightning:select> -->
                                <c:StatusPickLst options_="{!v.StatusPickList}" aura:id = "StatusPickList"/>
                            </p>
                        </div>
                        
                    </lightning:layoutItem>
                    
                    <lightning:layoutItem padding="around-none">
                        <div class="header-column">
                            <div class = "buttons">
                                <lightning:buttonGroup>
                                    <lightning:button  onclick="{!c.Reset}">Reset</lightning:button>
                                    <lightning:button  onclick="{!c.handleSelected}">Submit</lightning:button>
                                </lightning:buttonGroup>
                                
                                <lightning:buttonGroup>
                                    <lightning:button  onclick="{!c.program}">New Program</lightning:button>
                                    <lightning:button  onclick="{!c.handleSelected}">Delete Programs</lightning:button>
                                </lightning:buttonGroup>
                                <lightning:buttonGroup>
                                    <lightning:button  onclick="{!c.openmodal}">Upload feedback</lightning:button>
                                    <div role="dialog" tabindex="-1" aria-labelledby="header43" aura:id="Modalbox" class="slds-modal">
                                        <div class="slds-modal__container">
                                            <div class="slds-modal__header">
                                                <button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close" onclick="{!c.closeModal}">
                                                    
                                                    <span class="slds-assistive-text">Close</span>
                                                </button>
                                                <h2 id="header43" class="slds-text-heading--medium">Upload Feedback</h2>
                                            </div>
                                            <div class="slds-modal__content slds-p-around--medium">
                                                <div>
                                                    <c:UploadFeedback></c:UploadFeedback>
                                                </div>
                                            </div>
                                            <div class="slds-modal__footer">
                                                <lightning:button label="Cancel" onclick="{!c.closeModal}"></lightning:button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="slds-backdrop " aura:id="Modalbackdrop"></div>
                                    <lightning:button  onclick="{!c.downloadFeedbck}">Download Feedback</lightning:button>
                                </lightning:buttonGroup>
                                
                                <lightning:buttonGroup>
                                    <lightning:button  onclick="{!c.downloadRenewal}">Download All</lightning:button>
                                    <lightning:button  label="Customize table" onclick="{! c.opencustomizetable }"/>
                                </lightning:buttonGroup>
                                
                                
                            </div>
                        </div>
                    </lightning:layoutItem>
                    
                </lightning:layout>
                
            </div>
        </div>
        <lightning:datatable class="myCss" aura:id="customerTable"
                             keyField="ruleId__c"
                             data="{!v.data}"
                             columns="{!v.columns}"
                             onrowselection = "{!c.updateselectedtext}" 
                             sortedBy="{! v.sortedBy }"
                             sortedDirection="{! v.sortedDirection }"
                             defaultSortDirection="{! v.defaultSortDirection }"
                             hideCheckboxColumn="false"
                             onsort="{! c.updateColumnSorting }"
                             selectedRows="{!v.selection}"
                             TotalCount="{!v.TotalCount}"/>
        
                  <aura:if isTrue="{!v.spinner}">
        <div aura:id="spinnerId" class="slds-spinner_container">
            <div class="slds-spinner--brand  slds-spinner slds-spinner--large slds-is-relative" role="alert">
               <span class="slds-assistive-text">Loading...</span>
                <div class="slds-spinner__dot-a"></div>
                <div class="slds-spinner__dot-b"></div>
            </div>
        </div>
              </aura:if>
  
        <lightning:layout horizontalAlign="center" >
            <lightning:layoutItem padding="around-small" flexibility="auto">
                <lightning:button label="First" iconName="utility:left" iconPosition="left" variant="bare"
                                  onclick="{!c.onFirst}" disabled="{! v.currentPageNumber == 1}"/>
                
                
                <aura:iteration items="{!v.pageList}" var="item">
                    <span class="slds-p-horizontal_x-small">
                        <a onclick="{!c.processMe}" name="{!item}"
                           class="{! (v.currentPageNumber == item) ? 'selected' : ''}">{!item}</a>
                    </span>
                </aura:iteration>
                
                <span class="slds-p-horizontal_xxx-small">
                    <a>&nbsp;</a>
                </span>
                <span class="slds-p-horizontal_x-small">
                    <a onclick="{!c.processMe}" name="{!v.totalPages}"
                       class="{! (v.currentPageNumber == v.totalPages) ? 'selected' : ''}">{!v.totalPages}</a>
                </span>
                
                <lightning:button label="Last" iconName="utility:right" iconPosition="right" variant="bare"
                                  disabled="{! v.currentPageNumber == v.totalPages}" onclick="{!c.onLast}"/>
            </lightning:layoutItem>
        </lightning:layout>
        
            <aura:if isTrue="{!v.iscustomizetableopen}">        
        <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open" style="height:500px;">    
            <div class="slds-modal__container" style="width:50%;">
                

                <header class="slds-modal__header">
                    <lightning:buttonIcon iconName="utility:close"
                                          onclick="{! c.closecustomizetable }"
                                          alternativeText="closecustomizetable"
                                          variant="bare-inverse"
                                          class="slds-modal__close"/>            
                    
                </header>
                <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                    <lightning:dualListbox name="multipleOptions"  
                                           label= "Customize Table
                                                   (* fields cannot be Deselected)" 
                                           sourceLabel="Deselected" 
                                           selectedLabel="Selected" 
                                           options="{!v.options}" 
                                           value="{!v.values}" 
                                           onchange="{! c.handleChange }"
                                           fieldLevelHelp="Re-order and Hide/Show Columns"
                                           
                                           requiredOptions="{!v.requiredOptions}"/>
                    
                </div>
                <footer class="slds-modal__footer">                                           
                    <button class="slds-button slds-button_neutral slds-float_center" onclick="{! c.closecustomizetable }">Cancel</button>
                    <button class="slds-button slds-button_brand slds-float_center" onclick="{! c.applySelectedColumns }">Apply</button> 
                    
                    
                </footer>
            </div>
        </section>
    </aura:if> 
        
    </div> 
</aura:component>